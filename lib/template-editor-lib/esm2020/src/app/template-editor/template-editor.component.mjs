import { Component, EventEmitter, Input, Output, ViewChild, } from "@angular/core";
import { docxToEditableObjects } from "../../utils/docxParsers/docxToEditableObjects";
import { transformEditablePhrasesToViewablePhrases } from "../../utils/phrasesParsers/transformEditablePhrasesToViewablePhrases";
import { ViewMode, } from "../interfaces";
import { Zoom } from "../shared/zoom-class/Zoom";
import { FormControl, FormGroup, Validators } from "@angular/forms";
import * as i0 from "@angular/core";
import * as i1 from "../components/header/header.component";
import * as i2 from "../components/workspace/workspace.component";
import * as i3 from "../components/footer/footer.component";
import * as i4 from "@angular/forms";
export class AppComponent {
    constructor() {
        this.title = "template-editor";
        this.save = new EventEmitter();
        this.updatedTemplateInformation = new EventEmitter();
        this.editablePhrases = [];
        this.viewablePhrases = [];
        this.history = [];
        this.zoom = new Zoom();
        this.workspace = {
            dropingFile: false,
            fileDropDown: false,
            detailsModal: false,
            paperZoom: { value: 1 },
            dataZoom: { value: 1 },
            mode: ViewMode.edit,
            historyIndex: 0,
            lastModifiedEditablePhraseIndex: 0,
            lastSelection: { start: 0, end: 0 },
            needToFocus: false,
        };
        this.docxFile = {
            content: "",
            name: "",
            lastModifiedDate: 0,
        };
        this.templateInformationForm = new FormGroup({
            name: new FormControl(undefined, [Validators.required]),
            description: new FormControl(undefined, [Validators.required]),
        });
        this.fileBackdropHandlerListener = () => {
            const initCount = -1;
            let count = initCount;
            window.ondragover = (e) => {
                e.preventDefault();
            };
            const docxFileType = "application/vnd.openxmlformats-officedocument.wordprocessingml.document";
            window.ondragenter = (e) => {
                // if event contains a file with .docx extension
                if (e.dataTransfer.items[0].kind === "file" &&
                    e.dataTransfer.items[0].type === docxFileType) {
                    this.workspace.dropingFile = true;
                    count++;
                }
            };
            window.ondragleave = () => {
                count--;
                if (count < 0) {
                    this.workspace.dropingFile = false;
                    count = initCount;
                }
            };
            window.ondrop = (e) => {
                e.preventDefault();
                count = initCount;
                this.workspace.dropingFile = false;
                if (e.dataTransfer.items[0].kind === "file" &&
                    e.dataTransfer.items[0].type === docxFileType) {
                    this.setTemplateFromFile(e.dataTransfer.files[0]);
                }
            };
        };
        this.undo = () => {
            if (this.workspace.historyIndex > 0) {
                const editablePhrasesFromLastestElementInHistory = this.history[this.workspace.historyIndex].editablePhrases.map((a) => ({ ...a }));
                this.workspace.historyIndex--;
                this.workspace = {
                    ...this.workspace,
                    lastModifiedEditablePhraseIndex: this.history[this.workspace.historyIndex].lastModifiedEditablePhraseIndex,
                    lastSelection: this.history[this.workspace.historyIndex].selection,
                };
                editablePhrasesFromLastestElementInHistory.map((editablePhrase, index) => {
                    const editablePhraseFromHistory = this.history[this.workspace.historyIndex].editablePhrases[index];
                    if (editablePhrase.value !== editablePhraseFromHistory.value) {
                        this.editablePhrases[index] = {
                            ...this.history[this.workspace.historyIndex].editablePhrases[index],
                        };
                    }
                });
                this.updateViewablePhrasesValue();
            }
        };
        this.redo = () => {
            if (this.workspace.historyIndex + 1 <= this.history.length - 1) {
                const editablePhrasesFromLastestElementInHistory = this.history[this.workspace.historyIndex].editablePhrases.map((a) => ({
                    ...a,
                }));
                this.workspace.historyIndex++;
                this.workspace = {
                    ...this.workspace,
                    lastModifiedEditablePhraseIndex: this.history[this.workspace.historyIndex].lastModifiedEditablePhraseIndex,
                    lastSelection: this.history[this.workspace.historyIndex].selection,
                };
                editablePhrasesFromLastestElementInHistory.map((editablePhrase, index) => {
                    const editablePhraseFromHistory = this.history[this.workspace.historyIndex].editablePhrases[index];
                    if (editablePhrase.value !== editablePhraseFromHistory.value) {
                        this.editablePhrases[index] = { ...editablePhraseFromHistory };
                    }
                });
                this.updateViewablePhrasesValue();
            }
        };
    }
    saveHandler(docxFile) {
        this.save.emit(docxFile);
    }
    ngOnInit() {
        if (this.template) {
            this.setTemplateFromFile(this.template);
        }
        if (this.templateInformation) {
            this.templateInformationForm.setValue({
                name: this.templateInformation.name,
                description: this.templateInformation.description,
            });
        }
    }
    ngAfterViewInit() {
        this.fileBackdropHandlerListener();
        this.historyHandlerListener();
        this.changeModeWithHotkeysListener();
    }
    setTemplateFromInputEvent(inputEvent) {
        const inputFile = inputEvent.target;
        this.setTemplateFromFile(inputFile.files[0]);
    }
    setTemplateFromFile(inputFile) {
        const reader = new FileReader();
        reader.onloadend = (e) => {
            const data = e.target.result;
            this.docxFile = {
                // template storage
                ...this.docxFile,
                name: inputFile.name,
                lastModifiedDate: inputFile.lastModified,
                content: data,
            };
            docxToEditableObjects(inputFile).then((editableObjects) => {
                this.setPhrases(editableObjects);
            });
        };
        reader.readAsArrayBuffer(inputFile);
    }
    setPhrases(editableObjects) {
        this.editablePhrases = editableObjects.map((a) => ({ ...a }));
        this.history = [
            {
                editablePhrases: editableObjects.map((a) => ({ ...a })),
                lastModifiedEditablePhraseIndex: 0,
                selection: undefined,
            },
        ];
        this.workspace.historyIndex = 0;
        this.updatesPhrasesValues();
    }
    updateEditablePhrase(inputEvent, editablePhraseIndex) {
        const doesHistoryIndexIsPosibleInHistory = this.workspace.historyIndex < this.history.length - 1;
        if (doesHistoryIndexIsPosibleInHistory) {
            const historyCuttedAfterCurrentIndex = this.history.slice(0, this.workspace.historyIndex + 1);
            this.history = historyCuttedAfterCurrentIndex;
        }
        const selection = window.getSelection();
        const selectionRange = {
            start: selection.anchorOffset,
            end: selection.focusOffset,
        };
        const phraseElement = inputEvent.target;
        const modifiedPhrasesFromHistory = this.history[this.history.length - 1].editablePhrases.map((a) => ({ ...a }));
        modifiedPhrasesFromHistory[editablePhraseIndex].value =
            phraseElement.innerText;
        this.history.push({
            editablePhrases: [...modifiedPhrasesFromHistory].map((a) => ({ ...a })),
            lastModifiedEditablePhraseIndex: editablePhraseIndex,
            selection: selectionRange,
        });
        this.workspace = {
            ...this.workspace,
            lastModifiedEditablePhraseIndex: editablePhraseIndex,
            lastSelection: selectionRange,
            historyIndex: this.history.length - 1,
        };
        this.updateViewablePhrasesValue();
    }
    setMode(mode) {
        if (mode === ViewMode.edit) {
            this.workspace.mode = ViewMode.edit;
            this.updatesPhrasesValues();
        }
        else if (mode === ViewMode.view) {
            this.workspace.mode = ViewMode.view;
            this.updatesPhrasesValues();
        }
        else if (mode === ViewMode.simulation) {
            this.workspace.mode = ViewMode.simulation;
        }
        else if (mode === ViewMode.editView) {
            this.workspace.mode = ViewMode.editView;
            if (this.workspace.paperZoom.value >= 1) {
                this.workspace.paperZoom.value = 0.9;
            }
        }
    }
    hideModals() {
        this.workspace.detailsModal = false;
    }
    updateTemplateInformation() {
        if (this.templateInformationForm.valid) {
            this.templateInformation = {
                name: this.templateInformationForm.value.name,
                description: this.templateInformationForm.value.description,
            };
            this.updatedTemplateInformation.emit(this.templateInformation);
            this.hideModals();
        }
    }
    updatesPhrasesValues() {
        this.updateEditablePhrasesValue();
        this.updateViewablePhrasesValue();
    }
    updateEditablePhrasesValue() {
        this.workspace.lastModifiedEditablePhraseIndex = this.history[this.workspace.historyIndex].lastModifiedEditablePhraseIndex;
        this.editablePhrases = this.history[this.workspace.historyIndex].editablePhrases.map((a) => ({
            ...a,
        }));
        this.workspace.needToFocus = true;
        this.workspace.needToFocus = false;
    }
    updateViewablePhrasesValue() {
        const updatedViewablePhrases = transformEditablePhrasesToViewablePhrases(this.history[this.workspace.historyIndex].editablePhrases);
        if (this.viewablePhrases.length === updatedViewablePhrases.length) {
            updatedViewablePhrases.forEach((updatedViewablePhrase, index) => {
                if (this.viewablePhrases[index].value !== updatedViewablePhrase.value) {
                    this.viewablePhrases[index].value = updatedViewablePhrase.value;
                }
            });
        }
        else {
            this.viewablePhrases = transformEditablePhrasesToViewablePhrases(this.history[this.workspace.historyIndex].editablePhrases);
        }
    }
    changeModeWithHotkeysListener() {
        document.addEventListener("keydown", (e) => {
            // detect when shift + v or shift + V and detect when stop pressing
            if ((e.key === "z" || e.key === "Z") && e.shiftKey && e.altKey) {
                e.preventDefault();
                if (this.workspace.mode !== ViewMode.edit) {
                    this.setMode("edit");
                }
            }
            else if ((e.key === "x" || e.key === "X") && e.shiftKey && e.altKey) {
                e.preventDefault();
                if (this.workspace.mode !== ViewMode.view) {
                    this.setMode("view");
                }
            }
            else if ((e.key === "c" || e.key === "C") && e.shiftKey && e.altKey) {
                e.preventDefault();
                if (this.workspace.mode !== ViewMode.simulation) {
                    this.setMode("simulation");
                }
            }
        });
    }
    historyHandlerListener() {
        // add event listener to ctrl + z and ctrl + y
        document.addEventListener("keydown", (e) => {
            if (e.ctrlKey) {
                if (e.key === "z") {
                    e.preventDefault();
                    this.undo();
                }
                else if (e.key === "y") {
                    e.preventDefault();
                    this.redo();
                }
            }
        });
    }
}
AppComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.0.3", ngImport: i0, type: AppComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
AppComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.0.3", type: AppComponent, selector: "template-editor", inputs: { data: "data", template: "template", templateInformation: "templateInformation" }, outputs: { save: "save", updatedTemplateInformation: "updatedTemplateInformation" }, viewQueries: [{ propertyName: "uploadFileInput", first: true, predicate: ["uploadFileInput"], descendants: true }, { propertyName: "workspaceContainer", first: true, predicate: ["workspaceContainer"], descendants: true }], ngImport: i0, template: "<body>\r\n  <input\r\n    #uploadFileInput\r\n    (change)=\"setTemplateFromInputEvent($event)\"\r\n    class=\"invisible\"\r\n    type=\"file\"\r\n    id=\"template\"\r\n    name=\"template\"\r\n    accept=\".docx\"\r\n    />\r\n\r\n  <div\r\n    class=\"backdrop\"\r\n    [class.backdrop--hover]=\"workspace.dropingFile\"\r\n    (wheel)=\"$event.preventDefault()\"\r\n  >\r\n    <div class=\"backdrop__drop-file-msg\">\r\n      Abrir template\r\n    </div>\r\n  </div>\r\n\r\n  <div\r\n    class=\"backdrop-modal\"\r\n    [class.backdrop-modal--hover]=\"workspace.detailsModal\"\r\n    (click)=\"hideModals()\"\r\n  >\r\n    <form\r\n      class=\"backdrop-modal__details-modal\"\r\n      (click)=\"$event.stopPropagation()\"\r\n      [formGroup]=\"templateInformationForm\"\r\n      (submit)=\"updateTemplateInformation()\"\r\n    >\r\n      <p>Nombre del template:</p>\r\n      <input\r\n        class=\"backdrop-modal__details-modal__input\"\r\n        [value]=\"templateInformation?.name || ''\"\r\n        formControlName=\"name\"\r\n        nz-input\r\n        type=\"text\"\r\n      >\r\n      <p>Descripci\u00F3n:</p>\r\n      <textarea\r\n        class=\"backdrop-modal__details-modal__input backdrop-modal__details-modal__input--textarea\"\r\n        formControlName=\"description\"\r\n        nz-input\r\n      >{{templateInformation?.description}}</textarea>\r\n      <div class=\"backdrop-modal__details-modal__buttons-container\">\r\n        <button\r\n          class=\"backdrop-modal__details-modal__buttons-container__btn backdrop-modal__details-modal__buttons-container__btn--save\"\r\n          type=\"submit\"\r\n        >Guardar</button>\r\n        <button\r\n          class=\"backdrop-modal__details-modal__buttons-container__btn backdrop-modal__details-modal__buttons-container__btn--cancel\"\r\n          (click)=\"hideModals()\"\r\n          type=\"button\"\r\n        >\r\n          Cerrar\r\n        </button>\r\n      </div>\r\n    </form>\r\n  </div>\r\n\r\n  <app-header\r\n    [workspace]=\"workspace\"\r\n    [docxFile]=\"docxFile\"\r\n    [history]=\"history\"\r\n    [editablePhrases]=\"editablePhrases\"\r\n    [uploadFileInput]=\"uploadFileInput\"\r\n    (fileChange)=\"setTemplateFromInputEvent($event)\"\r\n    (docxFileChanged)=\"saveHandler($event)\"\r\n  ></app-header>\r\n\r\n  <app-workspace\r\n    [data]=\"data\"\r\n    [workspace]=\"workspace\"\r\n    [editablePhrases]=\"editablePhrases\"\r\n    [fileInput]=\"uploadFileInput\"\r\n    [viewablePhrases]=\"viewablePhrases\"\r\n    #workspaceContainer\r\n    style=\"flex-grow: 1; height: 100%; overflow: auto;\"\r\n    (editablePhraseChanged)=\"updateEditablePhrase($event.inputEvent, $event.indexOfEditablePhrase)\"\r\n  ></app-workspace>\r\n\r\n  <app-footer\r\n    [workspace]=\"workspace\"\r\n    (clickEditMode)=\"!$event.shiftKey ? setMode('edit') : setMode('editView')\"\r\n    (clickViewMode)=\"!$event.shiftKey ? setMode('view') : setMode('editView')\"\r\n    (clickSimulationMode)=\"setMode('simulation')\"\r\n  ></app-footer>\r\n</body>", styles: ["@font-face{font-family:Readex Pro;font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQzfm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQwBm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQxfm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQxtm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQyBnLw3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQy4nLw3.ttf) format(\"truetype\")}body{margin:0;position:relative;display:flex;flex-direction:column;font-family:Readex Pro,sans-serif;background-color:#f4f6f7;font-weight:300;box-sizing:border-box;height:100%;width:100%;--elements-color: #fff;--legalSizeSheet-width: 816px;--legalSizeSheet-height: 1344px;--header-height: 50px;--footer-height: 20px;--data-searchbar-height: 20px}.backdrop{display:flex;background:radial-gradient(circle,#000D 0%,#0009 70%,#0005 100%);position:absolute;top:0px;width:100%;height:100%;z-index:110000;justify-content:center;align-items:center;transition-duration:.3s;transition-property:opacity,visibility;opacity:0;visibility:hidden}.backdrop--hover{visibility:initial;opacity:1}.backdrop__drop-file-msg{font-size:5vw;color:#fff;font-weight:300;border-style:dashed;border-radius:.8vw;border-color:#fff;border-width:1vw;padding:1.5vw}.backdrop-modal{display:flex;background-color:#0009;position:absolute;top:0px;width:100%;height:100%;z-index:110000;justify-content:center;align-items:center;transition-duration:.3s;transition-property:opacity,visibility;opacity:0;visibility:hidden}.backdrop-modal--hover{visibility:initial;opacity:1}.backdrop-modal__details-modal{background-color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:4vw 3vw;font-size:2vw;border-radius:20px}.backdrop-modal__details-modal>*{margin:0;font-family:sans-serif;margin-bottom:1vw}.backdrop-modal__details-modal>*:last-child{margin-bottom:0}.backdrop-modal__details-modal__input{width:35vw;height:5vh;max-height:40px;font-size:1.5vw}.backdrop-modal__details-modal__input--textarea{max-height:150px;height:10vw;resize:none;font-size:1.3vw}.backdrop-modal__details-modal__buttons-container{display:flex;flex-direction:row}.backdrop-modal__details-modal__buttons-container__btn{width:10vw;height:4vw;font-size:1.5vw;border-radius:20px;border-style:solid;border-width:2px;cursor:pointer;transition-duration:.2s;margin-right:1vw}.backdrop-modal__details-modal__buttons-container__btn:last-child{margin-right:0}.backdrop-modal__details-modal__buttons-container__btn--save{border-color:#fff;background-color:#fff;border-color:#00a8ff}.backdrop-modal__details-modal__buttons-container__btn--save:hover{background-color:#00b9ff;border-color:#002fff}.backdrop-modal__details-modal__buttons-container__btn--cancel{border-color:#fff;background-color:#fff;border-color:red}.backdrop-modal__details-modal__buttons-container__btn--cancel:hover{background-color:red;border-color:red}\n", "*{box-sizing:border-box!important}.invisible{visibility:hidden;display:none}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#8888}::-webkit-scrollbar-thumb:hover{background:#555}\n"], components: [{ type: i1.HeaderComponent, selector: "app-header[history][docxFile][uploadFileInput][editablePhrases]", inputs: ["workspace", "docxFile", "history", "uploadFileInput", "editablePhrases"], outputs: ["fileChange", "docxFileChanged"] }, { type: i2.WorkspaceComponent, selector: "app-workspace[data][workspace][editablePhrases][fileInput][viewablePhrases]", inputs: ["data", "workspace", "editablePhrases", "fileInput", "viewablePhrases"], outputs: ["editablePhraseChanged"] }, { type: i3.FooterComponent, selector: "app-footer[workspace]", inputs: ["workspace"], outputs: ["clickEditMode", "clickViewMode", "clickSimulationMode"] }], directives: [{ type: i4.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { type: i4.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { type: i4.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { type: i4.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { type: i4.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i4.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.0.3", ngImport: i0, type: AppComponent, decorators: [{
            type: Component,
            args: [{ selector: "template-editor", template: "<body>\r\n  <input\r\n    #uploadFileInput\r\n    (change)=\"setTemplateFromInputEvent($event)\"\r\n    class=\"invisible\"\r\n    type=\"file\"\r\n    id=\"template\"\r\n    name=\"template\"\r\n    accept=\".docx\"\r\n    />\r\n\r\n  <div\r\n    class=\"backdrop\"\r\n    [class.backdrop--hover]=\"workspace.dropingFile\"\r\n    (wheel)=\"$event.preventDefault()\"\r\n  >\r\n    <div class=\"backdrop__drop-file-msg\">\r\n      Abrir template\r\n    </div>\r\n  </div>\r\n\r\n  <div\r\n    class=\"backdrop-modal\"\r\n    [class.backdrop-modal--hover]=\"workspace.detailsModal\"\r\n    (click)=\"hideModals()\"\r\n  >\r\n    <form\r\n      class=\"backdrop-modal__details-modal\"\r\n      (click)=\"$event.stopPropagation()\"\r\n      [formGroup]=\"templateInformationForm\"\r\n      (submit)=\"updateTemplateInformation()\"\r\n    >\r\n      <p>Nombre del template:</p>\r\n      <input\r\n        class=\"backdrop-modal__details-modal__input\"\r\n        [value]=\"templateInformation?.name || ''\"\r\n        formControlName=\"name\"\r\n        nz-input\r\n        type=\"text\"\r\n      >\r\n      <p>Descripci\u00F3n:</p>\r\n      <textarea\r\n        class=\"backdrop-modal__details-modal__input backdrop-modal__details-modal__input--textarea\"\r\n        formControlName=\"description\"\r\n        nz-input\r\n      >{{templateInformation?.description}}</textarea>\r\n      <div class=\"backdrop-modal__details-modal__buttons-container\">\r\n        <button\r\n          class=\"backdrop-modal__details-modal__buttons-container__btn backdrop-modal__details-modal__buttons-container__btn--save\"\r\n          type=\"submit\"\r\n        >Guardar</button>\r\n        <button\r\n          class=\"backdrop-modal__details-modal__buttons-container__btn backdrop-modal__details-modal__buttons-container__btn--cancel\"\r\n          (click)=\"hideModals()\"\r\n          type=\"button\"\r\n        >\r\n          Cerrar\r\n        </button>\r\n      </div>\r\n    </form>\r\n  </div>\r\n\r\n  <app-header\r\n    [workspace]=\"workspace\"\r\n    [docxFile]=\"docxFile\"\r\n    [history]=\"history\"\r\n    [editablePhrases]=\"editablePhrases\"\r\n    [uploadFileInput]=\"uploadFileInput\"\r\n    (fileChange)=\"setTemplateFromInputEvent($event)\"\r\n    (docxFileChanged)=\"saveHandler($event)\"\r\n  ></app-header>\r\n\r\n  <app-workspace\r\n    [data]=\"data\"\r\n    [workspace]=\"workspace\"\r\n    [editablePhrases]=\"editablePhrases\"\r\n    [fileInput]=\"uploadFileInput\"\r\n    [viewablePhrases]=\"viewablePhrases\"\r\n    #workspaceContainer\r\n    style=\"flex-grow: 1; height: 100%; overflow: auto;\"\r\n    (editablePhraseChanged)=\"updateEditablePhrase($event.inputEvent, $event.indexOfEditablePhrase)\"\r\n  ></app-workspace>\r\n\r\n  <app-footer\r\n    [workspace]=\"workspace\"\r\n    (clickEditMode)=\"!$event.shiftKey ? setMode('edit') : setMode('editView')\"\r\n    (clickViewMode)=\"!$event.shiftKey ? setMode('view') : setMode('editView')\"\r\n    (clickSimulationMode)=\"setMode('simulation')\"\r\n  ></app-footer>\r\n</body>", styles: ["@font-face{font-family:Readex Pro;font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQzfm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQwBm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQxfm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQxtm7w3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQyBnLw3.ttf) format(\"truetype\")}@font-face{font-family:Readex Pro;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/readexpro/v9/SLXYc1bJ7HE5YDoGPuzj_dh8na74KiwZQQy4nLw3.ttf) format(\"truetype\")}body{margin:0;position:relative;display:flex;flex-direction:column;font-family:Readex Pro,sans-serif;background-color:#f4f6f7;font-weight:300;box-sizing:border-box;height:100%;width:100%;--elements-color: #fff;--legalSizeSheet-width: 816px;--legalSizeSheet-height: 1344px;--header-height: 50px;--footer-height: 20px;--data-searchbar-height: 20px}.backdrop{display:flex;background:radial-gradient(circle,#000D 0%,#0009 70%,#0005 100%);position:absolute;top:0px;width:100%;height:100%;z-index:110000;justify-content:center;align-items:center;transition-duration:.3s;transition-property:opacity,visibility;opacity:0;visibility:hidden}.backdrop--hover{visibility:initial;opacity:1}.backdrop__drop-file-msg{font-size:5vw;color:#fff;font-weight:300;border-style:dashed;border-radius:.8vw;border-color:#fff;border-width:1vw;padding:1.5vw}.backdrop-modal{display:flex;background-color:#0009;position:absolute;top:0px;width:100%;height:100%;z-index:110000;justify-content:center;align-items:center;transition-duration:.3s;transition-property:opacity,visibility;opacity:0;visibility:hidden}.backdrop-modal--hover{visibility:initial;opacity:1}.backdrop-modal__details-modal{background-color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:4vw 3vw;font-size:2vw;border-radius:20px}.backdrop-modal__details-modal>*{margin:0;font-family:sans-serif;margin-bottom:1vw}.backdrop-modal__details-modal>*:last-child{margin-bottom:0}.backdrop-modal__details-modal__input{width:35vw;height:5vh;max-height:40px;font-size:1.5vw}.backdrop-modal__details-modal__input--textarea{max-height:150px;height:10vw;resize:none;font-size:1.3vw}.backdrop-modal__details-modal__buttons-container{display:flex;flex-direction:row}.backdrop-modal__details-modal__buttons-container__btn{width:10vw;height:4vw;font-size:1.5vw;border-radius:20px;border-style:solid;border-width:2px;cursor:pointer;transition-duration:.2s;margin-right:1vw}.backdrop-modal__details-modal__buttons-container__btn:last-child{margin-right:0}.backdrop-modal__details-modal__buttons-container__btn--save{border-color:#fff;background-color:#fff;border-color:#00a8ff}.backdrop-modal__details-modal__buttons-container__btn--save:hover{background-color:#00b9ff;border-color:#002fff}.backdrop-modal__details-modal__buttons-container__btn--cancel{border-color:#fff;background-color:#fff;border-color:red}.backdrop-modal__details-modal__buttons-container__btn--cancel:hover{background-color:red;border-color:red}\n", "*{box-sizing:border-box!important}.invisible{visibility:hidden;display:none}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#8888}::-webkit-scrollbar-thumb:hover{background:#555}\n"] }]
        }], propDecorators: { uploadFileInput: [{
                type: ViewChild,
                args: ["uploadFileInput"]
            }], workspaceContainer: [{
                type: ViewChild,
                args: ["workspaceContainer"]
            }], data: [{
                type: Input
            }], template: [{
                type: Input
            }], templateInformation: [{
                type: Input
            }], save: [{
                type: Output
            }], updatedTemplateInformation: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUtZWRpdG9yLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hcHAvdGVtcGxhdGUtZWRpdG9yL3RlbXBsYXRlLWVkaXRvci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvYXBwL3RlbXBsYXRlLWVkaXRvci90ZW1wbGF0ZS1lZGl0b3IuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLFNBQVMsRUFFVCxZQUFZLEVBQ1osS0FBSyxFQUNMLE1BQU0sRUFDTixTQUFTLEdBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFNdEYsT0FBTyxFQUFFLHlDQUF5QyxFQUFFLE1BQU0sc0VBQXNFLENBQUM7QUFDakksT0FBTyxFQUVMLFFBQVEsR0FLVCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDakQsT0FBTyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7Ozs7OztBQVVwRSxNQUFNLE9BQU8sWUFBWTtJQVJ6QjtRQVNFLFVBQUssR0FBRyxpQkFBaUIsQ0FBQztRQVNoQixTQUFJLEdBQTJCLElBQUksWUFBWSxFQUFZLENBQUM7UUFDNUQsK0JBQTBCLEdBRWhDLElBQUksWUFBWSxFQUF1QixDQUFDO1FBTXJDLG9CQUFlLEdBQXFCLEVBQUUsQ0FBQztRQUN2QyxvQkFBZSxHQUFxQixFQUFFLENBQUM7UUFDdkMsWUFBTyxHQUFjLEVBQUUsQ0FBQztRQUN4QixTQUFJLEdBQVMsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUV4QixjQUFTLEdBQWM7WUFDNUIsV0FBVyxFQUFFLEtBQUs7WUFDbEIsWUFBWSxFQUFFLEtBQUs7WUFDbkIsWUFBWSxFQUFFLEtBQUs7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RUFBRTtnQkFDckUsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO2dCQUNuQixJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxLQUFLLFFBQVEsQ0FBQyxVQUFVLEVBQUU7b0JBQy9DLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7aUJBQzVCO2FBQ0Y7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUE4RE8sc0JBQXNCO1FBQzVCLDhDQUE4QztRQUM5QyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDekMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFO2dCQUNiLElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxHQUFHLEVBQUU7b0JBQ2pCLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDbkIsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO2lCQUNiO3FCQUFNLElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxHQUFHLEVBQUU7b0JBQ3hCLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDbkIsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO2lCQUNiO2FBQ0Y7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7O3lHQXJWVSxZQUFZOzZGQUFaLFlBQVksdWNDbEN6Qix3K0ZBeUZPOzJGRHZETSxZQUFZO2tCQVJ4QixTQUFTOytCQUNFLGlCQUFpQjs4QkFTRyxlQUFlO3NCQUE1QyxTQUFTO3VCQUFDLGlCQUFpQjtnQkFDSyxrQkFBa0I7c0JBQWxELFNBQVM7dUJBQUMsb0JBQW9CO2dCQUl0QixJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSztnQkFDRyxtQkFBbUI7c0JBQTNCLEtBQUs7Z0JBQ0ksSUFBSTtzQkFBYixNQUFNO2dCQUNHLDBCQUEwQjtzQkFBbkMsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIElucHV0LFxyXG4gIE91dHB1dCxcclxuICBWaWV3Q2hpbGQsXHJcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgZG9jeFRvRWRpdGFibGVPYmplY3RzIH0gZnJvbSBcIi4uLy4uL3V0aWxzL2RvY3hQYXJzZXJzL2RvY3hUb0VkaXRhYmxlT2JqZWN0c1wiO1xyXG5pbXBvcnQge1xyXG4gIEVkaXRhYmxlUGhyYXNlLFxyXG4gIElucHV0RmlsZUZvcm1hdCxcclxuICBWaWV3YWJsZVBocmFzZSxcclxufSBmcm9tIFwiLi4vLi4vdXRpbHMvZG9jeFBhcnNlcnMvdHlwZXNcIjtcclxuaW1wb3J0IHsgdHJhbnNmb3JtRWRpdGFibGVQaHJhc2VzVG9WaWV3YWJsZVBocmFzZXMgfSBmcm9tIFwiLi4vLi4vdXRpbHMvcGhyYXNlc1BhcnNlcnMvdHJhbnNmb3JtRWRpdGFibGVQaHJhc2VzVG9WaWV3YWJsZVBocmFzZXNcIjtcclxuaW1wb3J0IHtcclxuICBEb2N4RmlsZSxcclxuICBWaWV3TW9kZSxcclxuICBXb3JrU3BhY2UsXHJcbiAgSGlzdG9yeSxcclxuICBTZWxlY3Rpb25SYW5nZSxcclxuICBUZW1wbGF0ZUluZm9ybWF0aW9uLFxyXG59IGZyb20gXCIuLi9pbnRlcmZhY2VzXCI7XHJcbmltcG9ydCB7IFpvb20gfSBmcm9tIFwiLi4vc2hhcmVkL3pvb20tY2xhc3MvWm9vbVwiO1xyXG5pbXBvcnQgeyBGb3JtQ29udHJvbCwgRm9ybUdyb3VwLCBWYWxpZGF0b3JzIH0gZnJvbSBcIkBhbmd1bGFyL2Zvcm1zXCI7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogXCJ0ZW1wbGF0ZS1lZGl0b3JcIixcclxuICB0ZW1wbGF0ZVVybDogXCIuL3RlbXBsYXRlLWVkaXRvci5jb21wb25lbnQuaHRtbFwiLFxyXG4gIHN0eWxlVXJsczogW1xyXG4gICAgXCIuL3RlbXBsYXRlLWVkaXRvci5jb21wb25lbnQubGVzc1wiLFxyXG4gICAgXCIuLi9zaGFyZWQvc3R5bGVzL2NvbW1vblN0eWxlcy5sZXNzXCIsXHJcbiAgXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIEFwcENvbXBvbmVudCB7XHJcbiAgdGl0bGUgPSBcInRlbXBsYXRlLWVkaXRvclwiO1xyXG4gIEBWaWV3Q2hpbGQoXCJ1cGxvYWRGaWxlSW5wdXRcIikgdXBsb2FkRmlsZUlucHV0OiBFbGVtZW50UmVmPEhUTUxJbnB1dEVsZW1lbnQ+O1xyXG4gIEBWaWV3Q2hpbGQoXCJ3b3Jrc3BhY2VDb250YWluZXJcIikgd29ya3NwYWNlQ29udGFpbmVyOiBFbGVtZW50UmVmPFxyXG4gICAgSFRNTERpdkVsZW1lbnRcclxuICA+O1xyXG5cclxuICBASW5wdXQoKSBkYXRhOiBhbnk7XHJcbiAgQElucHV0KCkgdGVtcGxhdGU6IElucHV0RmlsZUZvcm1hdDtcclxuICBASW5wdXQoKSB0ZW1wbGF0ZUluZm9ybWF0aW9uOiBUZW1wbGF0ZUluZm9ybWF0aW9uO1xyXG4gIEBPdXRwdXQoKSBzYXZlOiBFdmVudEVtaXR0ZXI8RG9jeEZpbGU+ID0gbmV3IEV2ZW50RW1pdHRlcjxEb2N4RmlsZT4oKTtcclxuICBAT3V0cHV0KCkgdXBkYXRlZFRlbXBsYXRlSW5mb3JtYXRpb246IEV2ZW50RW1pdHRlcjxcclxuICAgIFRlbXBsYXRlSW5mb3JtYXRpb25cclxuICA+ID0gbmV3IEV2ZW50RW1pdHRlcjxUZW1wbGF0ZUluZm9ybWF0aW9uPigpO1xyXG5cclxuICBwdWJsaWMgc2F2ZUhhbmRsZXIoZG9jeEZpbGU6IERvY3hGaWxlKSB7XHJcbiAgICB0aGlzLnNhdmUuZW1pdChkb2N4RmlsZSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZWRpdGFibGVQaHJhc2VzOiBFZGl0YWJsZVBocmFzZVtdID0gW107XHJcbiAgcHVibGljIHZpZXdhYmxlUGhyYXNlczogVmlld2FibGVQaHJhc2VbXSA9IFtdO1xyXG4gIHB1YmxpYyBoaXN0b3J5OiBIaXN0b3J5W10gPSBbXTtcclxuICBwdWJsaWMgem9vbTogWm9vbSA9IG5ldyBab29tKCk7XHJcblxyXG4gIHB1YmxpYyB3b3Jrc3BhY2U6IFdvcmtTcGFjZSA9IHtcclxuICAgIGRyb3BpbmdGaWxlOiBmYWxzZSxcclxuICAgIGZpbGVEcm9wRG93bjogZmFsc2UsXHJcbiAgICBkZXRhaWxzTW9kYWw6IGZhbHNlLFxyXG4gICAgcGFwZXJab29tOiB7IHZhbHVlOiAxIH0sXHJcbiAgICBkYXRhWm9vbTogeyB2YWx1ZTogMSB9LFxyXG4gICAgbW9kZTogVmlld01vZGUuZWRpdCxcclxuICAgIGhpc3RvcnlJbmRleDogMCxcclxuICAgIGxhc3RNb2RpZmllZEVkaXRhYmxlUGhyYXNlSW5kZXg6IDAsXHJcbiAgICBsYXN0U2VsZWN0aW9uOiB7IHN0YXJ0OiAwLCBlbmQ6IDAgfSxcclxuICAgIG5lZWRUb0ZvY3VzOiBmYWxzZSxcclxuICB9O1xyXG5cclxuICBwdWJsaWMgZG9jeEZpbGU6IERvY3hGaWxlID0ge1xyXG4gICAgY29udGVudDogXCJcIixcclxuICAgIG5hbWU6IFwiXCIsXHJcbiAgICBsYXN0TW9kaWZpZWREYXRlOiAwLFxyXG4gIH07XHJcblxyXG4gIHB1YmxpYyB0ZW1wbGF0ZUluZm9ybWF0aW9uRm9ybTogRm9ybUdyb3VwID0gbmV3IEZvcm1Hcm91cCh7XHJcbiAgICBuYW1lOiBuZXcgRm9ybUNvbnRyb2wodW5kZWZpbmVkLCBbVmFsaWRhdG9ycy5yZXF1aXJlZF0pLFxyXG4gICAgZGVzY3JpcHRpb246IG5ldyBGb3JtQ29udHJvbCh1bmRlZmluZWQsIFtWYWxpZGF0b3JzLnJlcXVpcmVkXSksXHJcbiAgfSk7XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgaWYgKHRoaXMudGVtcGxhdGUpIHtcclxuICAgICAgdGhpcy5zZXRUZW1wbGF0ZUZyb21GaWxlKHRoaXMudGVtcGxhdGUgYXMgRmlsZSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMudGVtcGxhdGVJbmZvcm1hdGlvbikge1xyXG4gICAgICB0aGlzLnRlbXBsYXRlSW5mb3JtYXRpb25Gb3JtLnNldFZhbHVlKHtcclxuICAgICAgICBuYW1lOiB0aGlzLnRlbXBsYXRlSW5mb3JtYXRpb24ubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy50ZW1wbGF0ZUluZm9ybWF0aW9uLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgIHRoaXMuZmlsZUJhY2tkcm9wSGFuZGxlckxpc3RlbmVyKCk7XHJcbiAgICB0aGlzLmhpc3RvcnlIYW5kbGVyTGlzdGVuZXIoKTtcclxuICAgIHRoaXMuY2hhbmdlTW9kZVdpdGhIb3RrZXlzTGlzdGVuZXIoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXRUZW1wbGF0ZUZyb21JbnB1dEV2ZW50KGlucHV0RXZlbnQ6IEV2ZW50KSB7XHJcbiAgICBjb25zdCBpbnB1dEZpbGUgPSBpbnB1dEV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgdGhpcy5zZXRUZW1wbGF0ZUZyb21GaWxlKGlucHV0RmlsZS5maWxlc1swXSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFRlbXBsYXRlRnJvbUZpbGUoaW5wdXRGaWxlOiBGaWxlKSB7XHJcbiAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgcmVhZGVyLm9ubG9hZGVuZCA9IChlKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgIHRoaXMuZG9jeEZpbGUgPSB7XHJcbiAgICAgICAgLy8gdGVtcGxhdGUgc3RvcmFnZVxyXG4gICAgICAgIC4uLnRoaXMuZG9jeEZpbGUsXHJcbiAgICAgICAgbmFtZTogaW5wdXRGaWxlLm5hbWUsXHJcbiAgICAgICAgbGFzdE1vZGlmaWVkRGF0ZTogaW5wdXRGaWxlLmxhc3RNb2RpZmllZCxcclxuICAgICAgICBjb250ZW50OiBkYXRhLFxyXG4gICAgICB9O1xyXG4gICAgICBkb2N4VG9FZGl0YWJsZU9iamVjdHMoaW5wdXRGaWxlKS50aGVuKChlZGl0YWJsZU9iamVjdHMpID0+IHtcclxuICAgICAgICB0aGlzLnNldFBocmFzZXMoZWRpdGFibGVPYmplY3RzKTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGlucHV0RmlsZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFBocmFzZXMoZWRpdGFibGVPYmplY3RzOiBFZGl0YWJsZVBocmFzZVtdKSB7XHJcbiAgICB0aGlzLmVkaXRhYmxlUGhyYXNlcyA9IGVkaXRhYmxlT2JqZWN0cy5tYXAoKGEpID0+ICh7IC4uLmEgfSkpO1xyXG4gICAgdGhpcy5oaXN0b3J5ID0gW1xyXG4gICAgICB7XHJcbiAgICAgICAgZWRpdGFibGVQaHJhc2VzOiBlZGl0YWJsZU9iamVjdHMubWFwKChhKSA9PiAoeyAuLi5hIH0pKSxcclxuICAgICAgICBsYXN0TW9kaWZpZWRFZGl0YWJsZVBocmFzZUluZGV4OiAwLFxyXG4gICAgICAgIHNlbGVjdGlvbjogdW5kZWZpbmVkLFxyXG4gICAgICB9LFxyXG4gICAgXTtcclxuICAgIHRoaXMud29ya3NwYWNlLmhpc3RvcnlJbmRleCA9IDA7XHJcbiAgICB0aGlzLnVwZGF0ZXNQaHJhc2VzVmFsdWVzKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgdXBkYXRlRWRpdGFibGVQaHJhc2UoXHJcbiAgICBpbnB1dEV2ZW50OiBJbnB1dEV2ZW50LFxyXG4gICAgZWRpdGFibGVQaHJhc2VJbmRleDogbnVtYmVyXHJcbiAgKSB7XHJcbiAgICBjb25zdCBkb2VzSGlzdG9yeUluZGV4SXNQb3NpYmxlSW5IaXN0b3J5ID1cclxuICAgICAgdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4IDwgdGhpcy5oaXN0b3J5Lmxlbmd0aCAtIDE7XHJcbiAgICBpZiAoZG9lc0hpc3RvcnlJbmRleElzUG9zaWJsZUluSGlzdG9yeSkge1xyXG4gICAgICBjb25zdCBoaXN0b3J5Q3V0dGVkQWZ0ZXJDdXJyZW50SW5kZXggPSB0aGlzLmhpc3Rvcnkuc2xpY2UoXHJcbiAgICAgICAgMCxcclxuICAgICAgICB0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXggKyAxXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuaGlzdG9yeSA9IGhpc3RvcnlDdXR0ZWRBZnRlckN1cnJlbnRJbmRleDtcclxuICAgIH1cclxuICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcclxuICAgIGNvbnN0IHNlbGVjdGlvblJhbmdlOiBTZWxlY3Rpb25SYW5nZSA9IHtcclxuICAgICAgc3RhcnQ6IHNlbGVjdGlvbi5hbmNob3JPZmZzZXQsXHJcbiAgICAgIGVuZDogc2VsZWN0aW9uLmZvY3VzT2Zmc2V0LFxyXG4gICAgfTtcclxuICAgIGNvbnN0IHBocmFzZUVsZW1lbnQgPSBpbnB1dEV2ZW50LnRhcmdldCBhcyBIVE1MU3BhbkVsZW1lbnQ7XHJcbiAgICBjb25zdCBtb2RpZmllZFBocmFzZXNGcm9tSGlzdG9yeSA9IHRoaXMuaGlzdG9yeVtcclxuICAgICAgdGhpcy5oaXN0b3J5Lmxlbmd0aCAtIDFcclxuICAgIF0uZWRpdGFibGVQaHJhc2VzLm1hcCgoYSkgPT4gKHsgLi4uYSB9KSk7XHJcbiAgICBtb2RpZmllZFBocmFzZXNGcm9tSGlzdG9yeVtlZGl0YWJsZVBocmFzZUluZGV4XS52YWx1ZSA9XHJcbiAgICAgIHBocmFzZUVsZW1lbnQuaW5uZXJUZXh0O1xyXG4gICAgdGhpcy5oaXN0b3J5LnB1c2goe1xyXG4gICAgICBlZGl0YWJsZVBocmFzZXM6IFsuLi5tb2RpZmllZFBocmFzZXNGcm9tSGlzdG9yeV0ubWFwKChhKSA9PiAoeyAuLi5hIH0pKSxcclxuICAgICAgbGFzdE1vZGlmaWVkRWRpdGFibGVQaHJhc2VJbmRleDogZWRpdGFibGVQaHJhc2VJbmRleCxcclxuICAgICAgc2VsZWN0aW9uOiBzZWxlY3Rpb25SYW5nZSxcclxuICAgIH0pO1xyXG4gICAgdGhpcy53b3Jrc3BhY2UgPSB7XHJcbiAgICAgIC4uLnRoaXMud29ya3NwYWNlLFxyXG4gICAgICBsYXN0TW9kaWZpZWRFZGl0YWJsZVBocmFzZUluZGV4OiBlZGl0YWJsZVBocmFzZUluZGV4LFxyXG4gICAgICBsYXN0U2VsZWN0aW9uOiBzZWxlY3Rpb25SYW5nZSxcclxuICAgICAgaGlzdG9yeUluZGV4OiB0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMSxcclxuICAgIH07XHJcbiAgICB0aGlzLnVwZGF0ZVZpZXdhYmxlUGhyYXNlc1ZhbHVlKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZmlsZUJhY2tkcm9wSGFuZGxlckxpc3RlbmVyID0gKCkgPT4ge1xyXG4gICAgY29uc3QgaW5pdENvdW50ID0gLTE7XHJcbiAgICBsZXQgY291bnQgPSBpbml0Q291bnQ7XHJcbiAgICB3aW5kb3cub25kcmFnb3ZlciA9IChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBkb2N4RmlsZVR5cGUgPVxyXG4gICAgICBcImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLmRvY3VtZW50XCI7XHJcbiAgICB3aW5kb3cub25kcmFnZW50ZXIgPSAoZSkgPT4ge1xyXG4gICAgICAvLyBpZiBldmVudCBjb250YWlucyBhIGZpbGUgd2l0aCAuZG9jeCBleHRlbnNpb25cclxuICAgICAgaWYgKFxyXG4gICAgICAgIGUuZGF0YVRyYW5zZmVyLml0ZW1zWzBdLmtpbmQgPT09IFwiZmlsZVwiICYmXHJcbiAgICAgICAgZS5kYXRhVHJhbnNmZXIuaXRlbXNbMF0udHlwZSA9PT0gZG9jeEZpbGVUeXBlXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMud29ya3NwYWNlLmRyb3BpbmdGaWxlID0gdHJ1ZTtcclxuICAgICAgICBjb3VudCsrO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgd2luZG93Lm9uZHJhZ2xlYXZlID0gKCkgPT4ge1xyXG4gICAgICBjb3VudC0tO1xyXG4gICAgICBpZiAoY291bnQgPCAwKSB7XHJcbiAgICAgICAgdGhpcy53b3Jrc3BhY2UuZHJvcGluZ0ZpbGUgPSBmYWxzZTtcclxuICAgICAgICBjb3VudCA9IGluaXRDb3VudDtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHdpbmRvdy5vbmRyb3AgPSAoZTogRHJhZ0V2ZW50KSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY291bnQgPSBpbml0Q291bnQ7XHJcbiAgICAgIHRoaXMud29ya3NwYWNlLmRyb3BpbmdGaWxlID0gZmFsc2U7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBlLmRhdGFUcmFuc2Zlci5pdGVtc1swXS5raW5kID09PSBcImZpbGVcIiAmJlxyXG4gICAgICAgIGUuZGF0YVRyYW5zZmVyLml0ZW1zWzBdLnR5cGUgPT09IGRvY3hGaWxlVHlwZVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLnNldFRlbXBsYXRlRnJvbUZpbGUoZS5kYXRhVHJhbnNmZXIuZmlsZXNbMF0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH07XHJcblxyXG4gIHB1YmxpYyBzZXRNb2RlKG1vZGU6IHN0cmluZykge1xyXG4gICAgaWYgKG1vZGUgPT09IFZpZXdNb2RlLmVkaXQpIHtcclxuICAgICAgdGhpcy53b3Jrc3BhY2UubW9kZSA9IFZpZXdNb2RlLmVkaXQ7XHJcbiAgICAgIHRoaXMudXBkYXRlc1BocmFzZXNWYWx1ZXMoKTtcclxuICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gVmlld01vZGUudmlldykge1xyXG4gICAgICB0aGlzLndvcmtzcGFjZS5tb2RlID0gVmlld01vZGUudmlldztcclxuICAgICAgdGhpcy51cGRhdGVzUGhyYXNlc1ZhbHVlcygpO1xyXG4gICAgfSBlbHNlIGlmIChtb2RlID09PSBWaWV3TW9kZS5zaW11bGF0aW9uKSB7XHJcbiAgICAgIHRoaXMud29ya3NwYWNlLm1vZGUgPSBWaWV3TW9kZS5zaW11bGF0aW9uO1xyXG4gICAgfSBlbHNlIGlmIChtb2RlID09PSBWaWV3TW9kZS5lZGl0Vmlldykge1xyXG4gICAgICB0aGlzLndvcmtzcGFjZS5tb2RlID0gVmlld01vZGUuZWRpdFZpZXc7XHJcbiAgICAgIGlmICh0aGlzLndvcmtzcGFjZS5wYXBlclpvb20udmFsdWUgPj0gMSkge1xyXG4gICAgICAgIHRoaXMud29ya3NwYWNlLnBhcGVyWm9vbS52YWx1ZSA9IDAuOTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGhpZGVNb2RhbHMoKSB7XHJcbiAgICB0aGlzLndvcmtzcGFjZS5kZXRhaWxzTW9kYWwgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyB1cGRhdGVUZW1wbGF0ZUluZm9ybWF0aW9uKCkge1xyXG4gICAgaWYgKHRoaXMudGVtcGxhdGVJbmZvcm1hdGlvbkZvcm0udmFsaWQpIHtcclxuICAgICAgdGhpcy50ZW1wbGF0ZUluZm9ybWF0aW9uID0ge1xyXG4gICAgICAgIG5hbWU6IHRoaXMudGVtcGxhdGVJbmZvcm1hdGlvbkZvcm0udmFsdWUubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy50ZW1wbGF0ZUluZm9ybWF0aW9uRm9ybS52YWx1ZS5kZXNjcmlwdGlvbixcclxuICAgICAgfTtcclxuICAgICAgdGhpcy51cGRhdGVkVGVtcGxhdGVJbmZvcm1hdGlvbi5lbWl0KHRoaXMudGVtcGxhdGVJbmZvcm1hdGlvbik7XHJcbiAgICAgIHRoaXMuaGlkZU1vZGFscygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVzUGhyYXNlc1ZhbHVlcygpIHtcclxuICAgIHRoaXMudXBkYXRlRWRpdGFibGVQaHJhc2VzVmFsdWUoKTtcclxuICAgIHRoaXMudXBkYXRlVmlld2FibGVQaHJhc2VzVmFsdWUoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlRWRpdGFibGVQaHJhc2VzVmFsdWUoKSB7XHJcbiAgICB0aGlzLndvcmtzcGFjZS5sYXN0TW9kaWZpZWRFZGl0YWJsZVBocmFzZUluZGV4ID0gdGhpcy5oaXN0b3J5W1xyXG4gICAgICB0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXhcclxuICAgIF0ubGFzdE1vZGlmaWVkRWRpdGFibGVQaHJhc2VJbmRleDtcclxuICAgIHRoaXMuZWRpdGFibGVQaHJhc2VzID0gdGhpcy5oaXN0b3J5W1xyXG4gICAgICB0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXhcclxuICAgIF0uZWRpdGFibGVQaHJhc2VzLm1hcCgoYSkgPT4gKHtcclxuICAgICAgLi4uYSxcclxuICAgIH0pKTtcclxuICAgIHRoaXMud29ya3NwYWNlLm5lZWRUb0ZvY3VzID0gdHJ1ZTtcclxuICAgIHRoaXMud29ya3NwYWNlLm5lZWRUb0ZvY3VzID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZVZpZXdhYmxlUGhyYXNlc1ZhbHVlKCkge1xyXG4gICAgY29uc3QgdXBkYXRlZFZpZXdhYmxlUGhyYXNlcyA9IHRyYW5zZm9ybUVkaXRhYmxlUGhyYXNlc1RvVmlld2FibGVQaHJhc2VzKFxyXG4gICAgICB0aGlzLmhpc3RvcnlbdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4XS5lZGl0YWJsZVBocmFzZXNcclxuICAgICk7XHJcbiAgICBpZiAodGhpcy52aWV3YWJsZVBocmFzZXMubGVuZ3RoID09PSB1cGRhdGVkVmlld2FibGVQaHJhc2VzLmxlbmd0aCkge1xyXG4gICAgICB1cGRhdGVkVmlld2FibGVQaHJhc2VzLmZvckVhY2goKHVwZGF0ZWRWaWV3YWJsZVBocmFzZSwgaW5kZXgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy52aWV3YWJsZVBocmFzZXNbaW5kZXhdLnZhbHVlICE9PSB1cGRhdGVkVmlld2FibGVQaHJhc2UudmFsdWUpIHtcclxuICAgICAgICAgIHRoaXMudmlld2FibGVQaHJhc2VzW2luZGV4XS52YWx1ZSA9IHVwZGF0ZWRWaWV3YWJsZVBocmFzZS52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy52aWV3YWJsZVBocmFzZXMgPSB0cmFuc2Zvcm1FZGl0YWJsZVBocmFzZXNUb1ZpZXdhYmxlUGhyYXNlcyhcclxuICAgICAgICB0aGlzLmhpc3RvcnlbdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4XS5lZGl0YWJsZVBocmFzZXNcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2hhbmdlTW9kZVdpdGhIb3RrZXlzTGlzdGVuZXIoKSB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICAvLyBkZXRlY3Qgd2hlbiBzaGlmdCArIHYgb3Igc2hpZnQgKyBWIGFuZCBkZXRlY3Qgd2hlbiBzdG9wIHByZXNzaW5nXHJcbiAgICAgIGlmICgoZS5rZXkgPT09IFwielwiIHx8IGUua2V5ID09PSBcIlpcIikgJiYgZS5zaGlmdEtleSAmJiBlLmFsdEtleSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBpZiAodGhpcy53b3Jrc3BhY2UubW9kZSAhPT0gVmlld01vZGUuZWRpdCkge1xyXG4gICAgICAgICAgdGhpcy5zZXRNb2RlKFwiZWRpdFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoKGUua2V5ID09PSBcInhcIiB8fCBlLmtleSA9PT0gXCJYXCIpICYmIGUuc2hpZnRLZXkgJiYgZS5hbHRLZXkpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaWYgKHRoaXMud29ya3NwYWNlLm1vZGUgIT09IFZpZXdNb2RlLnZpZXcpIHtcclxuICAgICAgICAgIHRoaXMuc2V0TW9kZShcInZpZXdcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKChlLmtleSA9PT0gXCJjXCIgfHwgZS5rZXkgPT09IFwiQ1wiKSAmJiBlLnNoaWZ0S2V5ICYmIGUuYWx0S2V5KSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGlmICh0aGlzLndvcmtzcGFjZS5tb2RlICE9PSBWaWV3TW9kZS5zaW11bGF0aW9uKSB7XHJcbiAgICAgICAgICB0aGlzLnNldE1vZGUoXCJzaW11bGF0aW9uXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgdW5kbyA9ICgpID0+IHtcclxuICAgIGlmICh0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXggPiAwKSB7XHJcbiAgICAgIGNvbnN0IGVkaXRhYmxlUGhyYXNlc0Zyb21MYXN0ZXN0RWxlbWVudEluSGlzdG9yeSA9IHRoaXMuaGlzdG9yeVtcclxuICAgICAgICB0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXhcclxuICAgICAgXS5lZGl0YWJsZVBocmFzZXMubWFwKChhKSA9PiAoeyAuLi5hIH0pKTtcclxuICAgICAgdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4LS07XHJcbiAgICAgIHRoaXMud29ya3NwYWNlID0ge1xyXG4gICAgICAgIC4uLnRoaXMud29ya3NwYWNlLFxyXG4gICAgICAgIGxhc3RNb2RpZmllZEVkaXRhYmxlUGhyYXNlSW5kZXg6IHRoaXMuaGlzdG9yeVtcclxuICAgICAgICAgIHRoaXMud29ya3NwYWNlLmhpc3RvcnlJbmRleFxyXG4gICAgICAgIF0ubGFzdE1vZGlmaWVkRWRpdGFibGVQaHJhc2VJbmRleCxcclxuICAgICAgICBsYXN0U2VsZWN0aW9uOiB0aGlzLmhpc3RvcnlbdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4XS5zZWxlY3Rpb24sXHJcbiAgICAgIH07XHJcbiAgICAgIGVkaXRhYmxlUGhyYXNlc0Zyb21MYXN0ZXN0RWxlbWVudEluSGlzdG9yeS5tYXAoXHJcbiAgICAgICAgKGVkaXRhYmxlUGhyYXNlLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZWRpdGFibGVQaHJhc2VGcm9tSGlzdG9yeSA9IHRoaXMuaGlzdG9yeVtcclxuICAgICAgICAgICAgdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4XHJcbiAgICAgICAgICBdLmVkaXRhYmxlUGhyYXNlc1tpbmRleF07XHJcbiAgICAgICAgICBpZiAoZWRpdGFibGVQaHJhc2UudmFsdWUgIT09IGVkaXRhYmxlUGhyYXNlRnJvbUhpc3RvcnkudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5lZGl0YWJsZVBocmFzZXNbaW5kZXhdID0ge1xyXG4gICAgICAgICAgICAgIC4uLnRoaXMuaGlzdG9yeVt0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXhdLmVkaXRhYmxlUGhyYXNlc1tcclxuICAgICAgICAgICAgICAgIGluZGV4XHJcbiAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMudXBkYXRlVmlld2FibGVQaHJhc2VzVmFsdWUoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBwdWJsaWMgcmVkbyA9ICgpID0+IHtcclxuICAgIGlmICh0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXggKyAxIDw9IHRoaXMuaGlzdG9yeS5sZW5ndGggLSAxKSB7XHJcbiAgICAgIGNvbnN0IGVkaXRhYmxlUGhyYXNlc0Zyb21MYXN0ZXN0RWxlbWVudEluSGlzdG9yeSA9IHRoaXMuaGlzdG9yeVtcclxuICAgICAgICB0aGlzLndvcmtzcGFjZS5oaXN0b3J5SW5kZXhcclxuICAgICAgXS5lZGl0YWJsZVBocmFzZXMubWFwKChhKSA9PiAoe1xyXG4gICAgICAgIC4uLmEsXHJcbiAgICAgIH0pKTtcclxuICAgICAgdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4Kys7XHJcbiAgICAgIHRoaXMud29ya3NwYWNlID0ge1xyXG4gICAgICAgIC4uLnRoaXMud29ya3NwYWNlLFxyXG4gICAgICAgIGxhc3RNb2RpZmllZEVkaXRhYmxlUGhyYXNlSW5kZXg6IHRoaXMuaGlzdG9yeVtcclxuICAgICAgICAgIHRoaXMud29ya3NwYWNlLmhpc3RvcnlJbmRleFxyXG4gICAgICAgIF0ubGFzdE1vZGlmaWVkRWRpdGFibGVQaHJhc2VJbmRleCxcclxuICAgICAgICBsYXN0U2VsZWN0aW9uOiB0aGlzLmhpc3RvcnlbdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4XS5zZWxlY3Rpb24sXHJcbiAgICAgIH07XHJcbiAgICAgIGVkaXRhYmxlUGhyYXNlc0Zyb21MYXN0ZXN0RWxlbWVudEluSGlzdG9yeS5tYXAoXHJcbiAgICAgICAgKGVkaXRhYmxlUGhyYXNlLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZWRpdGFibGVQaHJhc2VGcm9tSGlzdG9yeSA9IHRoaXMuaGlzdG9yeVtcclxuICAgICAgICAgICAgdGhpcy53b3Jrc3BhY2UuaGlzdG9yeUluZGV4XHJcbiAgICAgICAgICBdLmVkaXRhYmxlUGhyYXNlc1tpbmRleF07XHJcbiAgICAgICAgICBpZiAoZWRpdGFibGVQaHJhc2UudmFsdWUgIT09IGVkaXRhYmxlUGhyYXNlRnJvbUhpc3RvcnkudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5lZGl0YWJsZVBocmFzZXNbaW5kZXhdID0geyAuLi5lZGl0YWJsZVBocmFzZUZyb21IaXN0b3J5IH07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG4gICAgICB0aGlzLnVwZGF0ZVZpZXdhYmxlUGhyYXNlc1ZhbHVlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcHJpdmF0ZSBoaXN0b3J5SGFuZGxlckxpc3RlbmVyKCkge1xyXG4gICAgLy8gYWRkIGV2ZW50IGxpc3RlbmVyIHRvIGN0cmwgKyB6IGFuZCBjdHJsICsgeVxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgaWYgKGUuY3RybEtleSkge1xyXG4gICAgICAgIGlmIChlLmtleSA9PT0gXCJ6XCIpIHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIHRoaXMudW5kbygpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09IFwieVwiKSB7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICB0aGlzLnJlZG8oKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCI8Ym9keT5cclxuICA8aW5wdXRcclxuICAgICN1cGxvYWRGaWxlSW5wdXRcclxuICAgIChjaGFuZ2UpPVwic2V0VGVtcGxhdGVGcm9tSW5wdXRFdmVudCgkZXZlbnQpXCJcclxuICAgIGNsYXNzPVwiaW52aXNpYmxlXCJcclxuICAgIHR5cGU9XCJmaWxlXCJcclxuICAgIGlkPVwidGVtcGxhdGVcIlxyXG4gICAgbmFtZT1cInRlbXBsYXRlXCJcclxuICAgIGFjY2VwdD1cIi5kb2N4XCJcclxuICAgIC8+XHJcblxyXG4gIDxkaXZcclxuICAgIGNsYXNzPVwiYmFja2Ryb3BcIlxyXG4gICAgW2NsYXNzLmJhY2tkcm9wLS1ob3Zlcl09XCJ3b3Jrc3BhY2UuZHJvcGluZ0ZpbGVcIlxyXG4gICAgKHdoZWVsKT1cIiRldmVudC5wcmV2ZW50RGVmYXVsdCgpXCJcclxuICA+XHJcbiAgICA8ZGl2IGNsYXNzPVwiYmFja2Ryb3BfX2Ryb3AtZmlsZS1tc2dcIj5cclxuICAgICAgQWJyaXIgdGVtcGxhdGVcclxuICAgIDwvZGl2PlxyXG4gIDwvZGl2PlxyXG5cclxuICA8ZGl2XHJcbiAgICBjbGFzcz1cImJhY2tkcm9wLW1vZGFsXCJcclxuICAgIFtjbGFzcy5iYWNrZHJvcC1tb2RhbC0taG92ZXJdPVwid29ya3NwYWNlLmRldGFpbHNNb2RhbFwiXHJcbiAgICAoY2xpY2spPVwiaGlkZU1vZGFscygpXCJcclxuICA+XHJcbiAgICA8Zm9ybVxyXG4gICAgICBjbGFzcz1cImJhY2tkcm9wLW1vZGFsX19kZXRhaWxzLW1vZGFsXCJcclxuICAgICAgKGNsaWNrKT1cIiRldmVudC5zdG9wUHJvcGFnYXRpb24oKVwiXHJcbiAgICAgIFtmb3JtR3JvdXBdPVwidGVtcGxhdGVJbmZvcm1hdGlvbkZvcm1cIlxyXG4gICAgICAoc3VibWl0KT1cInVwZGF0ZVRlbXBsYXRlSW5mb3JtYXRpb24oKVwiXHJcbiAgICA+XHJcbiAgICAgIDxwPk5vbWJyZSBkZWwgdGVtcGxhdGU6PC9wPlxyXG4gICAgICA8aW5wdXRcclxuICAgICAgICBjbGFzcz1cImJhY2tkcm9wLW1vZGFsX19kZXRhaWxzLW1vZGFsX19pbnB1dFwiXHJcbiAgICAgICAgW3ZhbHVlXT1cInRlbXBsYXRlSW5mb3JtYXRpb24/Lm5hbWUgfHwgJydcIlxyXG4gICAgICAgIGZvcm1Db250cm9sTmFtZT1cIm5hbWVcIlxyXG4gICAgICAgIG56LWlucHV0XHJcbiAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICA+XHJcbiAgICAgIDxwPkRlc2NyaXBjacOzbjo8L3A+XHJcbiAgICAgIDx0ZXh0YXJlYVxyXG4gICAgICAgIGNsYXNzPVwiYmFja2Ryb3AtbW9kYWxfX2RldGFpbHMtbW9kYWxfX2lucHV0IGJhY2tkcm9wLW1vZGFsX19kZXRhaWxzLW1vZGFsX19pbnB1dC0tdGV4dGFyZWFcIlxyXG4gICAgICAgIGZvcm1Db250cm9sTmFtZT1cImRlc2NyaXB0aW9uXCJcclxuICAgICAgICBuei1pbnB1dFxyXG4gICAgICA+e3t0ZW1wbGF0ZUluZm9ybWF0aW9uPy5kZXNjcmlwdGlvbn19PC90ZXh0YXJlYT5cclxuICAgICAgPGRpdiBjbGFzcz1cImJhY2tkcm9wLW1vZGFsX19kZXRhaWxzLW1vZGFsX19idXR0b25zLWNvbnRhaW5lclwiPlxyXG4gICAgICAgIDxidXR0b25cclxuICAgICAgICAgIGNsYXNzPVwiYmFja2Ryb3AtbW9kYWxfX2RldGFpbHMtbW9kYWxfX2J1dHRvbnMtY29udGFpbmVyX19idG4gYmFja2Ryb3AtbW9kYWxfX2RldGFpbHMtbW9kYWxfX2J1dHRvbnMtY29udGFpbmVyX19idG4tLXNhdmVcIlxyXG4gICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXHJcbiAgICAgICAgPkd1YXJkYXI8L2J1dHRvbj5cclxuICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICBjbGFzcz1cImJhY2tkcm9wLW1vZGFsX19kZXRhaWxzLW1vZGFsX19idXR0b25zLWNvbnRhaW5lcl9fYnRuIGJhY2tkcm9wLW1vZGFsX19kZXRhaWxzLW1vZGFsX19idXR0b25zLWNvbnRhaW5lcl9fYnRuLS1jYW5jZWxcIlxyXG4gICAgICAgICAgKGNsaWNrKT1cImhpZGVNb2RhbHMoKVwiXHJcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcclxuICAgICAgICA+XHJcbiAgICAgICAgICBDZXJyYXJcclxuICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Zvcm0+XHJcbiAgPC9kaXY+XHJcblxyXG4gIDxhcHAtaGVhZGVyXHJcbiAgICBbd29ya3NwYWNlXT1cIndvcmtzcGFjZVwiXHJcbiAgICBbZG9jeEZpbGVdPVwiZG9jeEZpbGVcIlxyXG4gICAgW2hpc3RvcnldPVwiaGlzdG9yeVwiXHJcbiAgICBbZWRpdGFibGVQaHJhc2VzXT1cImVkaXRhYmxlUGhyYXNlc1wiXHJcbiAgICBbdXBsb2FkRmlsZUlucHV0XT1cInVwbG9hZEZpbGVJbnB1dFwiXHJcbiAgICAoZmlsZUNoYW5nZSk9XCJzZXRUZW1wbGF0ZUZyb21JbnB1dEV2ZW50KCRldmVudClcIlxyXG4gICAgKGRvY3hGaWxlQ2hhbmdlZCk9XCJzYXZlSGFuZGxlcigkZXZlbnQpXCJcclxuICA+PC9hcHAtaGVhZGVyPlxyXG5cclxuICA8YXBwLXdvcmtzcGFjZVxyXG4gICAgW2RhdGFdPVwiZGF0YVwiXHJcbiAgICBbd29ya3NwYWNlXT1cIndvcmtzcGFjZVwiXHJcbiAgICBbZWRpdGFibGVQaHJhc2VzXT1cImVkaXRhYmxlUGhyYXNlc1wiXHJcbiAgICBbZmlsZUlucHV0XT1cInVwbG9hZEZpbGVJbnB1dFwiXHJcbiAgICBbdmlld2FibGVQaHJhc2VzXT1cInZpZXdhYmxlUGhyYXNlc1wiXHJcbiAgICAjd29ya3NwYWNlQ29udGFpbmVyXHJcbiAgICBzdHlsZT1cImZsZXgtZ3JvdzogMTsgaGVpZ2h0OiAxMDAlOyBvdmVyZmxvdzogYXV0bztcIlxyXG4gICAgKGVkaXRhYmxlUGhyYXNlQ2hhbmdlZCk9XCJ1cGRhdGVFZGl0YWJsZVBocmFzZSgkZXZlbnQuaW5wdXRFdmVudCwgJGV2ZW50LmluZGV4T2ZFZGl0YWJsZVBocmFzZSlcIlxyXG4gID48L2FwcC13b3Jrc3BhY2U+XHJcblxyXG4gIDxhcHAtZm9vdGVyXHJcbiAgICBbd29ya3NwYWNlXT1cIndvcmtzcGFjZVwiXHJcbiAgICAoY2xpY2tFZGl0TW9kZSk9XCIhJGV2ZW50LnNoaWZ0S2V5ID8gc2V0TW9kZSgnZWRpdCcpIDogc2V0TW9kZSgnZWRpdFZpZXcnKVwiXHJcbiAgICAoY2xpY2tWaWV3TW9kZSk9XCIhJGV2ZW50LnNoaWZ0S2V5ID8gc2V0TW9kZSgndmlldycpIDogc2V0TW9kZSgnZWRpdFZpZXcnKVwiXHJcbiAgICAoY2xpY2tTaW11bGF0aW9uTW9kZSk9XCJzZXRNb2RlKCdzaW11bGF0aW9uJylcIlxyXG4gID48L2FwcC1mb290ZXI+XHJcbjwvYm9keT4iXX0=